<div>
  <h2>Управление товарами</h2>

  <a href="/product/create">
    Новая категория
  </a>

  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/noty/3.1.4/noty.min.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/noty/3.1.4/noty.min.js"></script>

  {{#if products.length}}
    <div class="product-list">
      {{#each products}}
        <div class="news-item card mb-3">
          <div class="card-body">
            <h3 class="card-title">{{name}}</h3>
            <div class="card-text">
              <p>Цена: {{price}}</p>
            </div>
            <div class="card-text">
              <p>Подкатегория: {{subcategory.id}}) {{subcategory.name}}</p>
            </div>

            <div class="actions mt-3">
              <a href="/product/{{id}}/update" class="btn btn-warning btn-sm">
                <i class="fas fa-edit"></i> Редактировать
              </a>
              <form action="/product/{{id}}/remove" method="POST">
                <button type="submit" class="btn btn-danger btn-sm">
                  <i class="fas fa-trash"></i> Удалить
                </button>
              </form>
            </div>
          </div>
        </div>
      {{/each}}
    </div>
  {{else}}
    <div class="alert alert-info">
      Нет товаров
    </div>
  {{/if}}
</div>


<style>
  .product-list .news-item {
    background: #fff;
    border-radius: 8px;
    transition: transform 0.2s;
  }

  .product-list .news-item:hover {
    transform: translateY(-3px);
    box-shadow: 0 4px 12px rgba(0,0,0,0.1);
  }
</style>
<script>
  const eventSource = new EventSource('/product/sse');

  eventSource.onmessage = (e) => {
    try {
      const data = JSON.parse(e.data);
      new Noty({
        text: `${data.type}`,
        type: 'info',
        timeout: 3000,
        layout: 'bottomRight'
      }).show();
    } catch (err) {
      new Noty({
        text: 'Ошибка формата данных',
        type: 'error',
        timeout: 3000,
        layout: 'bottomRight'
      }).show();
    }
  };
</script>